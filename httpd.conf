# Simple Apache2 Configuration for LDIF Converter
ServerRoot "/usr/local/apache2"

# Basic modules
LoadModule mpm_event_module modules/mod_mpm_event.so
LoadModule authz_core_module modules/mod_authz_core.so
LoadModule dir_module modules/mod_dir.so
LoadModule mime_module modules/mod_mime.so
LoadModule headers_module modules/mod_headers.so
LoadModule unixd_module modules/mod_unixd.so

# Basic server settings
User www-data
Group www-data
Listen 80
ServerName localhost:80
DocumentRoot "/usr/local/apache2/htdocs"

# Hide server information
ServerTokens Prod
ServerSignature Off

# Directory permissions
<Directory />
    AllowOverride None
    Require all denied
</Directory>

<Directory "/usr/local/apache2/htdocs">
    Options -Indexes
    AllowOverride None
    Require all granted
    
    # Security headers
    Header always set X-Frame-Options "DENY"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';"
    
    # CORS headers (restricted)
    Header always set Access-Control-Allow-Origin "http://localhost:8080"
    Header always set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, X-Requested-With"
</Directory>

# Default index files
<IfModule dir_module>
    DirectoryIndex index.html
</IfModule>

# MIME types
<IfModule mime_module>
    TypesConfig conf/mime.types
    AddType text/html .html
    AddType text/css .css
    AddType application/javascript .js
</IfModule>

# Error log only
ErrorLog /proc/self/fd/2
LogLevel warn

# Security: Limit request size to 10MB
LimitRequestBody 10485760

# Security: Timeout settings
Timeout 60
KeepAliveTimeout 5

# Security: Disable HTTP TRACE method
TraceEnable Off
